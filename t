
[34mfuntracker/src/migrations/02-Full-DB.sql[0m
[34m─────────────────────────────────────────────────────────────────────────────────────[0m

[34m────────────────────────────────────[0m[34m┐[0m
[34m14[0m: [38;2;249;38;114mCREATE[38;2;248;248;242m [38;2;249;38;114mTABLE[38;2;248;248;242m [38;2;166;226;46mestabelecimentos[38;2;248;248;242m ( [0m[34m│[0m
[34m────────────────────────────────────[0m[34m┘[0m
[38;2;249;38;114mCREATE[38;2;248;248;242m [38;2;249;38;114mTABLE[38;2;248;248;242m [38;2;166;226;46mavaliacoes[38;2;248;248;242m ([0m
[38;2;248;248;242m  id [38;2;102;217;239mINTEGER[38;2;248;248;242m UNIQUE [38;2;249;38;114mPRIMARY KEY[38;2;248;248;242m AUTOINCREMENT [38;2;249;38;114mNOT[38;2;248;248;242m [38;2;190;132;255mNULL[38;2;248;248;242m,[0m
[38;2;248;248;242m  valor [38;2;102;217;239mINTEGER[38;2;248;248;242m,[0m
[48;2;63;0;1m  [48;2;144;16;17mcomentarios[48;2;63;0;1m VARCHAR(1024),[0m[48;2;63;0;1m[0K[0m
[48;2;0;40;0;38;2;248;248;242m  [48;2;0;96;0mcomentario[48;2;0;40;0m [38;2;102;217;239mVARCHAR[38;2;248;248;242m([38;2;190;132;255m1024[38;2;248;248;242m),[0m[48;2;0;40;0m[0K[0m
[38;2;248;248;242m  [38;2;249;38;114mFOREIGN KEY[38;2;248;248;242m(estabelecimento_id) [38;2;249;38;114mREFERENCES[38;2;248;248;242m estabelecimentos(id),[0m
[38;2;248;248;242m  [38;2;249;38;114mFOREIGN KEY[38;2;248;248;242m(user_id) [38;2;249;38;114mREFERENCES[38;2;248;248;242m utilizadores(id)[0m
[38;2;248;248;242m);[0m

[34mfuntracker/src/model/Classificacao.ts[0m
[34m─────────────────────────────────────────────────────────────────────────────────────[0m

[34m───[0m[34m┐[0m
[34m1[0m: [34m│[0m
[34m───[0m[34m┘[0m
[48;2;63;0;1mimport {[48;2;144;16;17m [48;2;63;0;1mPromisedDatabase[48;2;144;16;17m [48;2;63;0;1m} from 'promised-sqlite3'[0m[48;2;63;0;1m[0K[0m
[48;2;0;40;0;38;2;249;38;114mimport[38;2;248;248;242m {[38;2;255;255;255mPromisedDatabase[38;2;248;248;242m} [38;2;249;38;114mfrom[38;2;248;248;242m [38;2;230;219;116m'promised-sqlite3'[48;2;0;96;0;38;2;248;248;242m;[0m[48;2;0;40;0m[0K[0m

[38;2;249;38;114mexport[38;2;248;248;242m [38;2;102;217;239mtype[38;2;248;248;242m [38;2;166;226;46mClassificacao[38;2;248;248;242m [38;2;249;38;114m=[38;2;248;248;242m {[0m
[48;2;63;0;1m  [48;2;144;16;17m  [48;2;63;0;1mid: number[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m  [48;2;144;16;17m  [48;2;63;0;1mvalor: number[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m  [48;2;144;16;17m  [48;2;63;0;1mcomentario: string | null[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m  [48;2;144;16;17m  [48;2;63;0;1mestabelecimentoNoturnoId: number[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m  [48;2;144;16;17m  [48;2;63;0;1mutilizadorId: number[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m}[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m[0K[0m
[48;2;63;0;1mexport class ClassificacaoDao {[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m    private readonly db: PromisedDatabase[0m[48;2;63;0;1m[0K[0m
[48;2;0;40;0;38;2;248;248;242m  id[38;2;249;38;114m:[38;2;248;248;242m [38;2;166;226;46mnumber[48;2;0;96;0;38;2;248;248;242m;[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m  valor[38;2;249;38;114m:[38;2;248;248;242m [38;2;166;226;46mnumber[48;2;0;96;0;38;2;248;248;242m;[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m  comentario[38;2;249;38;114m:[38;2;248;248;242m [38;2;166;226;46mstring[38;2;248;248;242m [38;2;249;38;114m|[38;2;248;248;242m [38;2;166;226;46mnull[48;2;0;96;0;38;2;248;248;242m;[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m  estabelecimentoNoturnoId[38;2;249;38;114m:[38;2;248;248;242m [38;2;166;226;46mnumber[48;2;0;96;0;38;2;248;248;242m;[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m  utilizadorId[38;2;249;38;114m:[38;2;248;248;242m [38;2;166;226;46mnumber[48;2;0;96;0;38;2;248;248;242m;[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m}[48;2;0;96;0m;[0m[48;2;0;40;0m[0K[0m

[48;2;63;0;1m  [48;2;144;16;17m  constructor([48;2;63;0;1mdb: PromisedDatabase[48;2;144;16;17m) {[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m        this.db = db[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m    }[0m[48;2;63;0;1m[0K[0m
[48;2;0;40;0;38;2;249;38;114mexport[38;2;248;248;242m [38;2;102;217;239mclass[38;2;248;248;242m [38;2;166;226;46mClassificacaoDAO[38;2;248;248;242m {[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m  [48;2;0;96;0;38;2;249;38;114mprivate[38;2;248;248;242m [38;2;249;38;114mreadonly[38;2;248;248;242m [48;2;0;40;0mdb[38;2;249;38;114m:[38;2;248;248;242m [38;2;166;226;46mPromisedDatabase[48;2;0;96;0;38;2;248;248;242m;[0m[48;2;0;40;0m[0K[0m

[48;2;63;0;1m    async createClassificacao(valor: number, comentario: string | null, estabelecimentoNoturnoId: number, utilizadorId: number): Promise<Classificacao> {[0m[48;2;63;0;1m[0K[0m
[48;2;0;40;0;38;2;248;248;242m  [38;2;102;217;239mconstructor[38;2;248;248;242m([38;2;253;151;31mdb[38;2;249;38;114m:[38;2;248;248;242m [38;2;166;226;46mPromisedDatabase[38;2;248;248;242m) {[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m    [38;2;255;255;255mthis[38;2;248;248;242m.[38;2;255;255;255mdb[38;2;248;248;242m [38;2;249;38;114m=[38;2;248;248;242m [38;2;255;255;255mdb[38;2;248;248;242m;[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m  }[0m[48;2;0;40;0m[0K[0m

[48;2;63;0;1m      [48;2;144;16;17m  let id = await this.db.run("[48;2;63;0;1mINSERT INTO avaliacoes (valor, comentarios, estabelecimento_id, user_id) VALUES (?, ?, ?, ?)[48;2;144;16;17m"[48;2;63;0;1m,[48;2;144;16;17m valor, comentario, estabelecimentoNoturnoId, utilizadorId)[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m    [48;2;144;16;17m    [48;2;63;0;1mreturn {[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m      [48;2;144;16;17m      [48;2;63;0;1mid: id.lastID,[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m      [48;2;144;16;17m      [48;2;63;0;1mvalor,[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m      [48;2;144;16;17m      [48;2;63;0;1mcomentario,[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m      [48;2;144;16;17m      [48;2;63;0;1mestabelecimentoNoturnoId,[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m            utilizadorId[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m  [48;2;144;16;17m      [48;2;63;0;1m}[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m  [48;2;144;16;17m  [48;2;63;0;1m}[0m[48;2;63;0;1m[0K[0m
[48;2;0;40;0;38;2;248;248;242m  [38;2;249;38;114masync[38;2;248;248;242m [38;2;166;226;46mcreateClassificacao[38;2;248;248;242m([0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m    [38;2;253;151;31mvalor[38;2;249;38;114m:[38;2;248;248;242m [38;2;166;226;46mnumber[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m    [38;2;253;151;31mcomentario[38;2;249;38;114m:[38;2;248;248;242m [38;2;166;226;46mstring[38;2;248;248;242m [38;2;249;38;114m|[38;2;248;248;242m [38;2;166;226;46mnull[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m    [38;2;253;151;31mestabelecimentoNoturnoId[38;2;249;38;114m:[38;2;248;248;242m [38;2;166;226;46mnumber[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m    [38;2;253;151;31mutilizadorId[38;2;249;38;114m:[38;2;248;248;242m [38;2;166;226;46mnumber[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m  )[38;2;249;38;114m:[38;2;248;248;242m [38;2;166;226;46mPromise[38;2;248;248;242m<[38;2;166;226;46mClassificacao[38;2;248;248;242m> {[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m    [38;2;102;217;239mlet[38;2;248;248;242m [38;2;255;255;255mid[38;2;248;248;242m [38;2;249;38;114m=[38;2;248;248;242m [38;2;249;38;114mawait[38;2;248;248;242m [38;2;255;255;255mthis[38;2;248;248;242m.[38;2;255;255;255mdb[38;2;248;248;242m.[38;2;166;226;46mrun[38;2;255;255;255m([0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      [48;2;0;96;0;38;2;230;219;116m'[48;2;0;40;0mINSERT INTO avaliacoes (valor, comentarios, estabelecimento_id, user_id) VALUES (?, ?, ?, ?)[48;2;0;96;0m'[48;2;0;40;0;38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      [38;2;255;255;255mvalor[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      [38;2;255;255;255mcomentario[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      [38;2;255;255;255mestabelecimentoNoturnoId[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      [38;2;255;255;255mutilizadorId[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m    [38;2;255;255;255m)[38;2;248;248;242m;[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m    [38;2;249;38;114mreturn[38;2;248;248;242m {[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      id: [38;2;255;255;255mid[38;2;248;248;242m.[38;2;255;255;255mlastID[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      [38;2;255;255;255mvalor[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      [38;2;255;255;255mcomentario[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      [38;2;255;255;255mestabelecimentoNoturnoId[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      [38;2;255;255;255mutilizadorId[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m    };[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m  }[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m  [38;2;249;38;114masync[38;2;248;248;242m [38;2;166;226;46mgetClassificacoesByID[38;2;248;248;242m([38;2;253;151;31muserID[38;2;249;38;114m:[38;2;248;248;242m [38;2;166;226;46mstring[38;2;248;248;242m)[38;2;249;38;114m:[38;2;248;248;242m [38;2;166;226;46mPromise[38;2;248;248;242m<[38;2;166;226;46mClassificacao[38;2;248;248;242m[]> {[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m    [38;2;249;38;114mreturn[38;2;248;248;242m [38;2;255;255;255m([0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      [38;2;249;38;114mawait[38;2;248;248;242m [38;2;255;255;255mthis[38;2;248;248;242m.[38;2;255;255;255mdb[38;2;248;248;242m.[38;2;102;217;239mall[38;2;255;255;255m([38;2;230;219;116m'SELECT * FROM avaliacoes WHERE user_id = ?'[38;2;248;248;242m, [38;2;255;255;255muserID)[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m    [38;2;255;255;255m)[38;2;248;248;242m.[38;2;166;226;46mmap[38;2;255;255;255m([38;2;253;151;31mc[38;2;248;248;242m [38;2;102;217;239m=>[38;2;248;248;242m [38;2;255;255;255m([38;2;248;248;242m{[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      id: [38;2;255;255;255mc[38;2;248;248;242m.id,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      valor: [38;2;255;255;255mc[38;2;248;248;242m.[38;2;255;255;255mvalor[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      comentario: [38;2;255;255;255mc[38;2;248;248;242m.[38;2;255;255;255mcomentario[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      estabelecimentoNoturnoId: [38;2;255;255;255mc[38;2;248;248;242m.[38;2;255;255;255mestabelecimento_id[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m      utilizadorId: [38;2;255;255;255mc[38;2;248;248;242m.[38;2;255;255;255muser_id[38;2;248;248;242m,[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m    }[38;2;255;255;255m))[38;2;248;248;242m;[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m  }[0m[48;2;0;40;0m[0K[0m
[38;2;248;248;242m}[0m

[34mfuntracker/src/routes/users.ts[0m
[34m─────────────────────────────────────────────────────────────────────────────────────[0m

[34m───[0m[34m┐[0m
[34m3[0m: [34m│[0m
[34m───[0m[34m┘[0m
[38;2;249;38;114mimport[38;2;248;248;242m { [38;2;255;255;255mRouter[38;2;248;248;242m } [38;2;249;38;114mfrom[38;2;248;248;242m [38;2;230;219;116m"express"[38;2;248;248;242m;[0m
[38;2;249;38;114mimport[38;2;248;248;242m { [38;2;255;255;255mbody[38;2;248;248;242m, [38;2;255;255;255mvalidationResult[38;2;248;248;242m } [38;2;249;38;114mfrom[38;2;248;248;242m [38;2;230;219;116m"express-validator"[38;2;248;248;242m;[0m
[38;2;249;38;114mimport[38;2;248;248;242m { [38;2;255;255;255mUserDAO[38;2;248;248;242m } [38;2;249;38;114mfrom[38;2;248;248;242m [38;2;230;219;116m"../model/User"[38;2;248;248;242m;[0m
[48;2;0;40;0;38;2;249;38;114mimport[38;2;248;248;242m { [38;2;255;255;255mClassificacaoDAO[38;2;248;248;242m } [38;2;249;38;114mfrom[38;2;248;248;242m [38;2;230;219;116m"../model/Classificacao"[38;2;248;248;242m;[0m[48;2;0;40;0m[0K[0m

[38;2;102;217;239mconst[38;2;248;248;242m [38;2;255;255;255musersRouter[38;2;248;248;242m [38;2;249;38;114m=[38;2;248;248;242m [38;2;166;226;46mRouter[38;2;255;255;255m()[0m


[34m──────────────────────────[0m[34m┐[0m
[34m37[0m: [38;2;255;255;255musersRouter[38;2;248;248;242m.[38;2;166;226;46mpost[38;2;255;255;255m([38;2;230;219;116m'/'[38;2;248;248;242m, [0m[34m│[0m
[34m──────────────────────────[0m[34m┘[0m
[38;2;248;248;242m    }[0m
[38;2;248;248;242m  })[0m

[48;2;63;0;1musersRouter.get('/:[48;2;144;16;17musername[48;2;63;0;1m', async (req, res) => {[0m[48;2;63;0;1m[0K[0m
[48;2;63;0;1m  // ... e aqui a de ir buscar informação sobre um![0m[48;2;63;0;1m[0K[0m
[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;255;255;255musersRouter[38;2;248;248;242m.[38;2;102;217;239mget[38;2;255;255;255m([38;2;230;219;116m'/:[48;2;0;96;0mid/historico[48;2;0;40;0m'[38;2;248;248;242m, [38;2;249;38;114masync[38;2;248;248;242m ([38;2;253;151;31mreq[38;2;248;248;242m, [38;2;253;151;31mres[38;2;248;248;242m) [38;2;102;217;239m=>[38;2;248;248;242m {[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m    [38;2;102;217;239mlet[38;2;248;248;242m [38;2;255;255;255mclassificacaoDAO[38;2;249;38;114m:[38;2;248;248;242m [38;2;166;226;46mClassificacaoDAO[38;2;248;248;242m [38;2;249;38;114m=[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m        [38;2;249;38;114mnew[38;2;248;248;242m [38;2;166;226;46mClassificacaoDAO[38;2;255;255;255m(req[38;2;248;248;242m.[38;2;255;255;255mapp[38;2;248;248;242m.[38;2;102;217;239mget[38;2;255;255;255m([38;2;230;219;116m'db'[38;2;255;255;255m))[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m    [38;2;249;38;114mreturn[38;2;248;248;242m [38;2;255;255;255mres[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m        .[38;2;166;226;46mstatus[38;2;255;255;255m([38;2;190;132;255m200[38;2;255;255;255m)[0m[48;2;0;40;0m[0K[0m
[48;2;0;40;0;38;2;248;248;242m        .[38;2;166;226;46mjson[38;2;255;255;255m(classificacaoDAO[38;2;248;248;242m.[38;2;166;226;46mgetClassificacoesByID[38;2;255;255;255m(req[38;2;248;248;242m.body.id[38;2;255;255;255m))[0m[48;2;0;40;0m[0K[0m
[38;2;248;248;242m}[38;2;255;255;255m)[0m

[48;2;63;0;1mexport default usersRouter[0m[48;2;63;0;1m[0K[0m
\ No newline at end of file[m
[48;2;0;40;0;38;2;249;38;114mexport[38;2;248;248;242m [38;2;249;38;114mdefault[38;2;248;248;242m [38;2;255;255;255musersRouter[0m[48;2;0;40;0m[0K[0m
